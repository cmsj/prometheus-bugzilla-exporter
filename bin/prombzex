#!/usr/bin/env python3
"""Prometheus Bugzilla Exporter"""

import sys
from prombzex import prombzex


def usage():
    """Print program usage"""
    print("Usage: %s CONFIGFILE", sys.argv[0])


def main():
    """Main entrypoint"""
    if len(sys.argv) != 2:
        usage()
        sys.exit(1)

    output = ""
    bzex = prombzex.PromBZEx(sys.argv[1])
    for server in bzex.servers():
        bzserver = bzex.server(server)

        for query in bzserver.query_names():
            print("Running: %s..." % query)
            output += bzserver.run_query(query)

    print(output)


if __name__ == '__main__':
    main()
